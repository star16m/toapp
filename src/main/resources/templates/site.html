<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/default"
>
<head>
<!-- #################### TITLE #################### -->
<title>Site</title>
<script>
var currentSite;
function clickSite(obj) {//id, name, searchUrl, selector, torrentNameSelector, torrentNameReplace, torrentSizeSelector, torrentSizeReplace, torrentMagnetSelector, torrentMagnetReplace
	currentSite = new Object();
	currentSite.id=$(obj).data('id');
	currentSite.name=$(obj).data('name');
	currentSite.searchUrl=$(obj).data('searchurl');
	currentSite.selector=$(obj).data('selector');
	
	currentSite.torrentNameSelector = $(obj).data('torrentnameselector');
	currentSite.torrentNameReplace  = $(obj).data('torrentnamereplace');
	
	currentSite.torrentSizeSelector = $(obj).data('torrentsizeselector');
	currentSite.torrentSizeReplace = $(obj).data('torrentsizereplace');
	
	currentSite.torrentMagnetHashSelector=$(obj).data('torrentmagnethashselector');
	currentSite.torrentMagnetHashReplace=$(obj).data('torrentmagnethashreplace');
	
	$('#siteName').val(currentSite.name);
	$('#siteSearchUrl').val(currentSite.searchUrl);
	$('#siteSelector').val(currentSite.selector);
	
	console.log(currentSite);
}
function changeEnabled(checkTarget) {
    return $.ajax({
        url: "/site",
        type: "patch",
        cache: false,
        data: {'siteId': $(checkTarget).data('siteid'), 'enabled':$(checkTarget).is(":checked")},
        dataType: 'json'
    });
}
</script>
</head>
<body>

<!-- #################### PAGE-TITLE #################### -->
<section layout:fragment="page-title">
   	<h1 class="page-header">Site</h1>
</section>

<!-- #################### CONTENT #################### -->
<section layout:fragment="content">
            <div class="row">
	            <div class="panel-body">
	                <div class="table-responsive">
	                    <table class="table table-striped table-bordered">
	                        <thead>
	                            <tr>
	                                <th>#</th>
	                                <th>사이트명</th>
	                                <th>URL</th>
	                                <th>A-Tag Selector</th>
	                                <th>name</th>
	                                <th>nameRe</th>
	                                <th>size</th>
	                                <th>sizeRe</th>
	                                <th>magnet</th>
	                                <th>magnetRe</th>
	                                <th>사용</th>
	                            </tr>
	                        </thead>
	                        <tbody>
	                            <tr th:each="site : ${sites}">
	                                <td th:text="${site.id}">id</td>
	                                <td>
	                                	<a th:text="${site.name}" th:onclick="|javascript:clickSite(this);|" th:attr="data-id=${site.id},data-name=${site.name},data-searchUrl=${site.searchUrl},data-selector=${site.selector},data-torrentNameSelector=${site.torrentNameSelector},data-torrentNameReplace=${site.torrentNameReplace}, data-torrentSizeSelector=${site.torrentSizeSelector}, data-torrentSizeReplace=${site.torrentSizeReplace}, data-torrentMagnetHashSelector=${site.torrentMagnetHashSelector},data-torrentMagnetHashReplace=${site.torrentMagnetHashReplace}">name
	                                	</a>
	                                </td>
	                                <td th:text="${site.searchUrl}">searchUrl</td>
	                                <td th:text="${site.selector}">selector</td>
	                                <td th:text="${site.torrentNameSelector}">torrentNameSelector</td>
	                                <td th:text="${site.torrentNameReplace}">torrentNameReplace</td>
	                                <td th:text="${site.torrentSizeSelector}">torrentSizeSelector</td>
	                                <td th:text="${site.torrentSizeReplace}">torrentSizeReplace</td>
	                                <td th:text="${site.torrentMagnetHashSelector}">torrentMagnetSelector</td>
	                                <td th:text="${site.torrentMagnetHashReplace}">torrentMagnetReplace</td>
	                                <td><input type="checkbox" name="active" th:checked="${site.useable}" th:attr="data-siteid=${site.id}" th:onclick="|javascript:changeEnabled(this);|"/></td>
	                            </tr>
	                        </tbody>
	                    </table>
	                </div>
	                <!-- /.table-responsive -->
	            </div>
                        
            </div>
            <!-- /.row -->
			<div class="row">
				<div class="col-lg-12">
					<div class="panel panel-primary">
						<div class="panel-heading">사이트 입력</div>
						
						<div class="panel-body">
							<form role="form" class="form" method="post" th:action="@{/site}" th:object="${siteCreate}">
							<div class="row">
								<div class="col-lg-6">
										<div class="form-group" th:classappend="${#fields.hasErrors('siteName')}? 'has-error'">
											<label class="control-label" for="siteName">사이트명</label>
											<input class="form-control" id="siteName" placeholder="사이트명" th:field="*{siteName}"/>
											<span th:if="${#fields.hasErrors('siteName')}" th:errors="*{siteName}" class="text-danger">error!</span>
										</div>
										<div class="form-group" th:classappend="${#fields.hasErrors('siteSearchUrl')}? 'has-error'">
											<label class="control-label" for="siteSearchUrl">URL</label>
											<input class="form-control" id="siteSearchUrl" placeholder="[KEYWORD] 를 포함한 search url" th:field="*{siteSearchUrl}"/>
											<span th:if="${#fields.hasErrors('siteSearchUrl')}" th:errors="*{siteSearchUrl}" class="help-block">error!</span>
										</div>
										<div class="form-group" th:classappend="${#fields.hasErrors('siteKeyword')}? 'has-error'">
											<label class="control-label" for="siteKeyword">검색문자열</label>
											<input class="form-control" id="siteKeyword" placeholder="[KEYWORD] 에 입력할 검색어" th:field="*{siteKeyword}"/>
											<span th:if="${#fields.hasErrors('siteKeyword')}" th:errors="*{siteKeyword}" class="help-block">error!</span>
										</div>
										<div class="form-group" th:classappend="${#fields.hasErrors('siteSelector')}? 'has-error'">
											<label class="control-label" for="siteSelector">selector</label>
											<input class="form-control" id="siteSelector" placeholder="a tag를 리스트업 하는 selector" th:field="*{siteSelector}"/>
											<span th:if="${#fields.hasErrors('siteSelector')}" th:errors="*{siteSelector}" class="help-block">error!</span>
										</div>
										
										<div class="form-group" th:classappend="${#fields.hasErrors('torrentNameSelector')}? 'has-error'">
											<label class="control-label" for="torrentNameSelector">토렌트-이름-Selector</label>
											<input class="form-control" id="torrentNameSelector" placeholder="토렌트-이름-Selector" th:field="*{torrentNameSelector}" />
											<span th:if="${#fields.hasErrors('torrentNameSelector')}" th:errors="*{torrentNameSelector}" class="text-danger">error!</span>
											<span th:if="${torrentNameResult}" th:text="${torrentNameResult}">torrent name result</span>
										</div>
										<div class="form-group" th:classappend="${#fields.hasErrors('torrentNameReplace')}? 'has-error'">
											<label class="control-label" for="torrentNameReplace">토렌트-이름-Replace</label>
											<input class="form-control" id="torrentNameReplace" placeholder="토렌트-이름-Replace" th:field="*{torrentNameReplace}" />
											<span th:if="${#fields.hasErrors('torrentNameReplace')}" th:errors="*{torrentNameReplace}" class="text-danger">error!</span>
										</div>
										
										<div class="form-group" th:classappend="${#fields.hasErrors('torrentSizeSelector')}? 'has-error'">
											<label class="control-label" for="torrentSizeSelector">토렌트-Size-Selector</label>
											<input class="form-control" id="torrentSizeSelector" placeholder="토렌트-Size-Selector" th:field="*{torrentSizeSelector}" />
											<span th:if="${#fields.hasErrors('torrentSizeSelector')}" th:errors="*{torrentSizeSelector}" class="text-danger">error!</span>
											<span th:if="${torrentSizeResult}" th:text="${torrentSizeResult}">torrent size result</span>
										</div>
										<div class="form-group" th:classappend="${#fields.hasErrors('torrentSizeReplace')}? 'has-error'">
											<label class="control-label" for="torrentSizeReplace">토렌트-Size-Replace</label>
											<input class="form-control" id="torrentSizeReplace" placeholder="토렌트-Size-Replace" th:field="*{torrentSizeReplace}" />
											<span th:if="${#fields.hasErrors('torrentSizeReplace')}" th:errors="*{torrentSizeReplace}" class="text-danger">error!</span>
										</div>
										
										<div class="form-group" th:classappend="${#fields.hasErrors('torrentMagnetHashSelector')}? 'has-error'">
											<label class="control-label" for="torrentMagnetHashSelector">토렌트-Magnet-Selector</label>
											<input class="form-control" id="torrentMagnetHashSelector" placeholder="토렌트-MagnetHash-Selector" th:field="*{torrentMagnetHashSelector}" />
											<span th:if="${#fields.hasErrors('torrentMagnetHashSelector')}" th:errors="*{torrentMagnetHashSelector}" class="text-danger">error!</span>
											<span th:if="${torrentMagnetHashResult}" th:text="${torrentMagnetHashResult}">torrent magnet hash result</span>
										</div>
										<div class="form-group" th:classappend="${#fields.hasErrors('torrentMagnetHashReplace')}? 'has-error'">
											<label class="control-label" for="torrentMagnetHashReplace">토렌트-Magnet-Replace</label>
											<input class="form-control" id="torrentMagnetHashReplace" placeholder="토렌트-Magnet-Replace" th:field="*{torrentMagnetHashReplace}" />
											<span th:if="${#fields.hasErrors('torrentMagnetHashReplace')}" th:errors="*{torrentMagnetHashReplace}" class="text-danger">error!</span>
										</div>
										
										<div class="form-group">
											<button type="submit" class="btn btn-primary btn-lg">check</button>
										</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label>리스트 페이지</label>
										<textarea class="form-control" rows="5" disabled="disabled" th:utext="${siteResult}"></textarea>
									</div>
									<div class="form-group" th:unless="${#strings.isEmpty(siteDetailResult)}">
										<label>상세 페이지</label>
										<textarea class="form-control" rows="5" disabled="disabled" th:utext="${siteDetailResult}"></textarea>
									</div>
								</div>
							</div>
							</form>
							</div>
					</div>
				</div>
			</div>
</section>
</body>

</html>
